\chapter{External Environment}

\begin{constant}{internal-time-units-per-second}{}{}{}
  
\end{constant}

\begin{function}{apropos}{string-designator \op package external-only}{}{}
  Briefly describe all symbols which contain the specified STRING.
  If PACKAGE is supplied then only describe symbols present in
  that package. If EXTERNAL-ONLY then only describe
  external symbols in the specified package.
\end{function}

\begin{function}{apropos-list}{string-designator \op package-designator external-only}{}{}
  Like APROPOS, except that it returns a list of the symbols found instead
  of describing them.
\end{function}

\begin{function}{decode-universal-time}{universal-time \op time-zone}{}{}
  Converts a universal-time to decoded time format returning the following
   nine values: second, minute, hour, date, month, year, day of week (0 =
   Monday), T (daylight savings time) or NIL (standard time), and timezone.
   Completely ignores daylight-savings-time when time-zone is supplied.
\end{function}

\begin{function}{describe}{x \op stream-designator}{}{}
  Print a description of the object X.
\end{function}

\begin{function}{disassemble}{object \key stream use-labels}{}{}
  Disassemble the compiled code associated with OBJECT, which can be a
  function, a lambda expression, or a symbol with a function definition. If
  it is not already compiled, the compiler is called to produce something to
  disassemble.
\end{function}

\begin{function}{dribble}{\op pathname \key if-exists}{}{}
  With a file name as an argument, dribble opens the file and sends a
  record of further I/O to that file. Without an argument, it closes
  the dribble file, and quits logging.
\end{function}

\begin{function}{ed}{\op x}{}{}
  Starts the editor (on a file or a function if named).  Functions
from the list *ED-FUNCTIONS* are called in order with X as an argument
until one of them returns non-NIL; these functions are responsible for
signalling a FILE-ERROR to indicate failure to perform an operation on
the file system.
\end{function}

\begin{function}{encode-universal-time}{second minute hour date month year \op time-zone}{}{}
  The time values specified in decoded format are converted to
   universal time, which is returned.
\end{function}

\begin{function}{get-decoded-time}{}{}{}
  Return nine values specifying the current time as follows:
   second, minute, hour, date, month, year, day of week (0 = Monday), T
   (daylight savings times) or NIL (standard time), and timezone.
\end{function}

\begin{function}{get-internal-real-time}{}{}{}
  Return the real time ("wallclock time") since startup in the internal
time format. (See INTERNAL-TIME-UNITS-PER-SECOND.)
\end{function}

\begin{function}{get-internal-run-time}{}{}{}
  Return the run time used by the process in the internal time format. (See
INTERNAL-TIME-UNITS-PER-SECOND.) This is useful for finding CPU usage.
Includes both "system" and "user" time.
\end{function}

\begin{function}{get-universal-time}{}{}{}
  Return a single integer for the current time of day in universal time
format.
\end{function}

\begin{function}{inspect}{object}{}{}
  
\end{function}

\begin{function}{lisp-implementation-type}{}{}{}
  
\end{function}

\begin{function}{lisp-implementation-version}{}{}{}
  
\end{function}

\begin{function}{long-site-name}{}{}{}
  Return a string with the long form of the site name, or NIL if not known.
\end{function}

\begin{function}{machine-instance}{}{}{}
  Return a string giving the name of the local machine.
\end{function}

\begin{function}{machine-type}{}{}{}
  Return a string describing the type of the local machine.
\end{function}

\begin{function}{machine-version}{}{}{}
  Return a string describing the version of the computer hardware we
are running on, or NIL if we can't find any useful information.
\end{function}

\begin{function}{room}{\op verbosity}{}{}
  Print to *STANDARD-OUTPUT* information about the state of internal
  storage and its management. The optional argument controls the
  verbosity of output. If it is T, ROOM prints out a maximal amount of
  information. If it is NIL, ROOM prints out a minimal amount of
  information. If it is :DEFAULT or it is not supplied, ROOM prints out
  an intermediate amount of information.
\end{function}

\begin{function}{short-site-name}{}{}{}
  Return a string with the abbreviated site name, or NIL if not known.
\end{function}

\begin{function}{sleep}{n}{}{}
  This function causes execution to be suspended for N seconds. N may
  be any non-negative, non-complex number.
\end{function}

\begin{function}{software-type}{}{}{}
  Return a string describing the supporting software.
\end{function}

\begin{function}{software-version}{}{}{}
  Return a string describing version of the supporting software, or NIL
  if not available.
\end{function}

\begin{function}{user-homedir-pathname}{\op host}{}{}
  Return the home directory of the user as a pathname. If the HOME
environment variable has been specified, the directory it designates
is returned; otherwise obtains the home directory from the operating
system.
\end{function}

\begin{generic}{describe-object}{x stream}{}{}
  
\end{generic}

\begin{generic}{documentation}{slotd doc-type}{}{}
  Return the documentation string of Doc-Type for X, or NIL if
  none exists. System doc-types are VARIABLE, FUNCTION, STRUCTURE, TYPE,
  SETF, and T.
\end{generic}

\begin{macro}{step}{form}{}{}
  The form is evaluated with single stepping enabled. Function calls
outside the lexical scope of the form can be stepped into only if the
functions in question have been compiled with sufficient DEBUG policy
to be at least partially steppable.
\end{macro}

\begin{macro}{time}{form}{}{}
  Execute FORM and print timing information on *TRACE-OUTPUT*.

On some hardware platforms estimated processor cycle counts are
included in this output; this number is slightly inflated, since it
includes the pipeline involved in reading the cycle counter --
executing (TIME NIL) a few times will give you an idea of the
overhead, and its variance. The cycle counters are also per processor,
not per thread: if multiple threads are running on the same processor,
the reported counts will include cycles taken up by all threads
running on the processor where TIME was executed. Furthermore, if the
operating system migrates the thread to another processor between
reads of the cycle counter, the results will be completely bogus.
Finally, the counter is cycle counter, incremented by the hardware
even when the process is halted -- which is to say that cycles pass
normally during operations like SLEEP.
\end{macro}

\begin{macro}{trace}{\rest specs}{}{}
  TRACE {Option Global-Value}* {Name {Option Value}*}*

TRACE is a debugging tool that provides information when specified
functions are called. In its simplest form:

       (TRACE NAME-1 NAME-2 ...)

The NAMEs are not evaluated. Each may be a symbol, denoting an
individual function, or a string, denoting all functions fbound to
symbols whose home package is the package with the given name.

Options allow modification of the default behavior. Each option is a
pair of an option keyword and a value form. Global options are
specified before the first name, and affect all functions traced by a
given use of TRACE. Options may also be interspersed with function
names, in which case they act as local options, only affecting tracing
of the immediately preceding function name. Local options override
global options.

By default, TRACE causes a printout on *TRACE-OUTPUT* each time that
one of the named functions is entered or returns. (This is the basic,
ANSI Common Lisp behavior of TRACE.) As an SBCL extension, the
:REPORT SB-EXT:PROFILE option can be used to instead cause information
to be silently recorded to be inspected later using the SB-EXT:PROFILE
function.

The following options are defined:

   :REPORT Report-Type
       If Report-Type is TRACE (the default) then information is reported
       by printing immediately. If Report-Type is SB-EXT:PROFILE, information
       is recorded for later summary by calls to SB-EXT:PROFILE. If
       Report-Type is NIL, then the only effect of the trace is to execute
       other options (e.g. PRINT or BREAK).

   :CONDITION Form
   :CONDITION-AFTER Form
   :CONDITION-ALL Form
       If :CONDITION is specified, then TRACE does nothing unless Form
       evaluates to true at the time of the call. :CONDITION-AFTER is
       similar, but suppresses the initial printout, and is tested when the
       function returns. :CONDITION-ALL tries both before and after.
       This option is not supported with :REPORT PROFILE.

   :BREAK Form
   :BREAK-AFTER Form
   :BREAK-ALL Form
       If specified, and Form evaluates to true, then the debugger is invoked
       at the start of the function, at the end of the function, or both,
       according to the respective option.

   :PRINT Form
   :PRINT-AFTER Form
   :PRINT-ALL Form
       In addition to the usual printout, the result of evaluating Form is
       printed at the start of the function, at the end of the function, or
       both, according to the respective option. Multiple print options cause
       multiple values to be printed.

   :WHEREIN Names
       If specified, Names is a function name or list of names. TRACE does
       nothing unless a call to one of those functions encloses the call to
       this function (i.e. it would appear in a backtrace.)  Anonymous
       functions have string names like "DEFUN FOO". This option is not
       supported with :REPORT PROFILE.

   :ENCAPSULATE {:DEFAULT | T | NIL}
       If T, the tracing is done via encapsulation (redefining the function
       name) rather than by modifying the function. :DEFAULT is the default,
       and means to use encapsulation for interpreted functions and funcallable
       instances, breakpoints otherwise. When encapsulation is used, forms are
       *not* evaluated in the function's lexical environment, but SB-DEBUG:ARG
       can still be used.

   :METHODS {T | NIL}
       If T, any function argument naming a generic function will have its
       methods traced in addition to the generic function itself.

   :FUNCTION Function-Form
       This is a not really an option, but rather another way of specifying
       what function to trace. The Function-Form is evaluated immediately,
       and the resulting function is instrumented, i.e. traced or profiled
       as specified in REPORT.

:CONDITION, :BREAK and :PRINT forms are evaluated in a context which
mocks up the lexical environment of the called function, so that
SB-DEBUG:VAR and SB-DEBUG:ARG can be used. The -AFTER and -ALL forms
are evaluated in the null environment.
\end{macro}

\begin{macro}{untrace}{\rest specs}{}{}
  Remove tracing from the specified functions. Untraces all
functions when called with no arguments.
\end{macro}

\begin{variable}{*}{\rest args}{}{}
  Return the product of its arguments. With no args, returns 1.
\end{variable}

\begin{variable}{**}{}{}{}
  
\end{variable}

\begin{variable}{***}{}{}{}
  
\end{variable}

\begin{variable}{+}{\rest args}{}{}
  Return the sum of its arguments. With no args, returns 0.
\end{variable}

\begin{variable}{++}{}{}{}
  
\end{variable}

\begin{variable}{+++}{}{}{}
  
\end{variable}

\begin{variable}{-}{number \rest more-numbers}{}{}
  Subtract the second and all subsequent arguments from the first;
  or with one argument, negate the first argument.
\end{variable}

\begin{variable}{/}{number \rest more-numbers}{}{}
  Divide the first argument by each of the following arguments, in turn.
  With one argument, return reciprocal.
\end{variable}

\begin{variable}{//}{}{}{}
  
\end{variable}

\begin{variable}{///}{}{}{}
  
\end{variable}

\section{Extensions}
\label{sec:extensions}

\begin{function}{quit}{\op exit-code}{arnesi}{}
  
\end{function}

\begin{function}{getenv}{var}{arnesi}{}
  
\end{function}

\begin{function}{argv}{var}{kroger}{}
  
\end{function}

\begin{macro}{def-special-environment}{name \key \rest vars}{arnesi}{}
  Define two macros for dealing with groups or related special variables.

ACCESSOR is defined as a macro: (defmacro ACCESSOR (VARS \&rest
BODY)).  Each element of VARS will be bound to the
current (dynamic) value of the special variable.

BINDER is defined as a macro for introducing (and binding new)
special variables. It is basically a readable LET form with the
prorpe declarations appended to the body. The first argument to
BINDER must be a form suitable as the first argument to LET.

ACCESSOR defaults to a new symbol in the same package as NAME
which is the concatenation of "WITH-" NAME. BINDER is built as
"BIND-" and BINDER* is BINDER "*".
\end{macro}

\begin{function}{collect-timing}{lambda}{arnesi}{}
  Executes LAMBDA and returns a timing-info object specifying
  how long execution took and how much memory was used.

NB: Not all implementations provide all information. See the
various \%collect-timing definitions for details.
\end{function}

